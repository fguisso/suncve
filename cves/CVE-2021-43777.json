{"cveId": "CVE-2021-43777", "cwe": ["CWE-352", "CWE-601", "CWE-352", "CWE-601"], "cvss": [{"baseScore": "6.8", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "High", "Privileges Required": "Low", "User Interaction": "None", "Scope": "Unchaged", "Confidentiality Impact": "High", "Integrity Impact": "High", "Availability Impact": "None"}], "references": ["https://github.com/getredash/redash/security/advisories/GHSA-vhc7-w7r8-8m34", "https://github.com/getredash/redash/commit/da696ff7f84787cbf85967460fac52886cbe063e"], "description": ["Redash is a package for data visualization and sharing. In Redash version 10.0 and prior, the implementation of Google Login (via OAuth) incorrectly uses the `state` parameter to pass the next URL to redirect the user to after login. The `state` parameter should be used for a Cross-Site Request Forgery (CSRF) token, not a static and easily predicted value. This vulnerability does not affect users who do not use Google Login for their instance of Redash. A patch in the `master` and `release/10.x.x` branches addresses this by replacing `Flask-Oauthlib` with `Authlib` which automatically provides and validates a CSRF token for the state variable. The new implementation stores the next URL on the user session object. As a workaround, one may disable Google Login to mitigate the vulnerability."], "published": "2021-11-24T16:15:14.257", "state": "PUBLIC", "vendorName": ["getredash"], "productName": ["redash"], "github": {"advisories": ["https://github.com/getredash/redash/security/advisories/GHSA-vhc7-w7r8-8m34"], "commits": ["https://github.com/getredash/redash/commit/da696ff7f84787cbf85967460fac52886cbe063e"], "pocAdvisorie": {}, "repo": "https://github.com/getredash/redash/", "info": {"exist": true, "topics": ["analytics", "athena", "bi", "bigquery", "business-intelligence", "dashboard", "databricks", "hacktoberfest", "javascript", "mysql", "postgresql", "python", "redash", "redshift", "spark", "spark-sql", "visualization"], "langs": {"Python": 1415461, "JavaScript": 1003436, "TypeScript": 534237, "Less": 196991, "HTML": 34162, "Shell": 5429, "Dockerfile": 3627, "Makefile": 2308, "CSS": 2135, "Mako": 494}, "avatar": "https://avatars.githubusercontent.com/u/10746780?v=4", "stargazers": 27173, "language": "Python"}}, "pocList": []}