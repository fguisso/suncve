{"cveId": "CVE-2021-39228", "cwe": ["CWE-416", "CWE-825", "CWE-416", "CWE-416", "CWE-825", "CWE-416"], "cvss": [{"baseScore": "6.5", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "Low", "Privileges Required": "None", "User Interaction": "None", "Scope": "Unchaged", "Confidentiality Impact": "Low", "Integrity Impact": "Low", "Availability Impact": "None"}], "references": ["https://github.com/tremor-rs/tremor-runtime/security/advisories/GHSA-mc22-5q92-8v85", "https://github.com/tremor-rs/tremor-runtime/pull/1217", "https://github.com/tremor-rs/tremor-runtime/commit/1a2efcdbe68e5e7fd0a05836ac32d2cde78a0b2e", "https://github.com/tremor-rs/tremor-runtime/releases/tag/v0.11.6"], "description": ["Tremor is an event processing system for unstructured data. A vulnerability exists between versions 0.7.2 and 0.11.6. This vulnerability is a memory safety Issue when using `patch` or `merge` on `state` and assign the result back to `state`. In this case, affected versions of Tremor and the tremor-script crate maintains references to memory that might have been freed already. And these memory regions can be accessed by retrieving the `state`, e.g. send it over TCP or HTTP. This requires the Tremor server (or any other program using tremor-script) to execute a tremor-script script that uses the mentioned language construct. The issue has been patched in version 0.11.6 by removing the optimization and always cloning the target expression of a Merge or Patch. If an upgrade is not possible, a possible workaround is to avoid the optimization by introducing a temporary variable and not immediately reassigning to `state`."], "published": "2021-09-17T14:15:08.413", "state": "PUBLIC", "vendorName": ["tremor-rs"], "productName": ["tremor-runtime"], "github": {"advisories": ["https://github.com/tremor-rs/tremor-runtime/security/advisories/GHSA-mc22-5q92-8v85"], "commits": ["https://github.com/tremor-rs/tremor-runtime/commit/1a2efcdbe68e5e7fd0a05836ac32d2cde78a0b2e"], "pocAdvisorie": {}, "repo": "https://github.com/tremor-rs/tremor-runtime/", "info": {"exist": true, "topics": ["hacktoberfest", "hacktoberfest2021", "rust", "tremor", "tremor-languages", "tremor-query", "tremor-runtime", "tremor-script"], "langs": {"Rust": 4387511, "Erlang": 74532, "Shell": 31448, "Emacs Lisp": 12224, "Makefile": 8470, "Dockerfile": 5331, "C++": 57, "Reason": 55}, "avatar": "https://avatars.githubusercontent.com/u/60009416?v=4", "stargazers": 890, "language": "Rust"}}, "pocList": []}