{"cveId": "CVE-2024-34359", "cwe": ["CWE-76", "CWE-76", "CWE-76"], "cvss": [{"baseScore": "9.6", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "Low", "Privileges Required": "None", "User Interaction": "Required", "Scope": "Complete", "Confidentiality Impact": "High", "Integrity Impact": "High", "Availability Impact": "High"}], "references": ["https://github.com/abetlen/llama-cpp-python/security/advisories/GHSA-56xg-wfcc-g829", "https://github.com/abetlen/llama-cpp-python/commit/b454f40a9a1787b2b5659cd2cb00819d983185df"], "description": ["llama-cpp-python is the Python bindings for llama.cpp. `llama-cpp-python` depends on class `Llama` in `llama.py` to load `.gguf` llama.cpp or Latency Machine Learning Models. The `__init__` constructor built in the `Llama` takes several parameters to configure the loading and running of the model. Other than `NUMA, LoRa settings`, `loading tokenizers,` and `hardware settings`, `__init__` also loads the `chat template` from targeted `.gguf` 's Metadata and furtherly parses it to `llama_chat_format.Jinja2ChatFormatter.to_chat_handler()` to construct the `self.chat_handler` for this model. Nevertheless, `Jinja2ChatFormatter` parse the `chat template` within the Metadate with sandbox-less `jinja2.Environment`, which is furthermore rendered in `__call__` to construct the `prompt` of interaction. This allows `jinja2` Server Side Template Injection which leads to remote code execution by a carefully constructed payload."], "published": "2024-05-14T15:38:45.093", "state": "PUBLIC", "vendorName": ["abetlen"], "productName": ["llama-cpp-python"], "github": {"advisories": ["https://github.com/abetlen/llama-cpp-python/security/advisories/GHSA-56xg-wfcc-g829"], "commits": ["https://github.com/abetlen/llama-cpp-python/commit/b454f40a9a1787b2b5659cd2cb00819d983185df"], "pocAdvisorie": {"url": "https://github.com/abetlen/llama-cpp-python/security/advisories/GHSA-56xg-wfcc-g829", "kw": ["poc"]}, "repo": "https://github.com/abetlen/llama-cpp-python/", "info": {"exist": true, "topics": [], "langs": {"Python": 568312, "CMake": 6738, "Shell": 5703, "Dockerfile": 3987, "Makefile": 2355}, "avatar": "https://avatars.githubusercontent.com/u/6826477?v=4", "stargazers": 8910, "language": "Python"}}, "pocList": []}