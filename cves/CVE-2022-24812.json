{"cveId": "CVE-2022-24812", "cwe": ["CWE-269", "CWE-269"], "cvss": [{"baseScore": "8.0", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "High", "Privileges Required": "High", "User Interaction": "None", "Scope": "Complete", "Confidentiality Impact": "High", "Integrity Impact": "High", "Availability Impact": "High"}], "references": ["https://github.com/grafana/grafana/security/advisories/GHSA-82gq-xfg3-5j7v", "https://grafana.com/blog/2022/04/12/grafana-enterprise-8.4.6-released-with-high-severity-security-fix/", "https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-4-6/", "https://security.netapp.com/advisory/ntap-20220519-0005/"], "description": ["Grafana is an open-source platform for monitoring and observability. When fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should. The vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned. All installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disable fine-grained access control will mitigate the vulnerability."], "published": "2022-04-12T17:15:09.503", "state": "PUBLIC", "vendorName": ["grafana"], "productName": ["grafana"], "github": {"advisories": ["https://github.com/grafana/grafana/security/advisories/GHSA-82gq-xfg3-5j7v"], "commits": [], "pocAdvisorie": {}, "repo": "https://github.com/grafana/grafana/", "info": {"exist": true, "topics": ["alerting", "analytics", "business-intelligence", "dashboard", "data-visualization", "elasticsearch", "go", "grafana", "hacktoberfest", "influxdb", "metrics", "monitoring", "mysql", "postgres", "prometheus"], "langs": {"TypeScript": 31634526, "Go": 22690679, "HTML": 293989, "CUE": 231201, "JavaScript": 203431, "MDX": 151403, "Shell": 150950, "Starlark": 131618, "SCSS": 112108, "Jsonnet": 39410, "Makefile": 28101, "Dockerfile": 17132, "Jinja": 5716, "Python": 4687, "HCL": 4097, "CSS": 3116, "Mustache": 2716, "Smarty": 2116, "PowerShell": 367, "Assembly": 168}, "avatar": "https://avatars.githubusercontent.com/u/7195757?v=4", "stargazers": 67378, "language": "TypeScript"}}, "pocList": []}