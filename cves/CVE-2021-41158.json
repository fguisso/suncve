{"cveId": "CVE-2021-41158", "cwe": ["CWE-200", "CWE-346", "CWE-200", "CWE-346"], "cvss": [{"baseScore": "5.8", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "Low", "Privileges Required": "None", "User Interaction": "None", "Scope": "Complete", "Confidentiality Impact": "Low", "Integrity Impact": "None", "Availability Impact": "None"}], "references": ["https://github.com/signalwire/freeswitch/releases/tag/v1.10.7", "https://github.com/signalwire/freeswitch/security/advisories/GHSA-3v3f-99mv-qvj4", "http://seclists.org/fulldisclosure/2021/Oct/40"], "description": ["FreeSWITCH is a Software Defined Telecom Stack enabling the digital transformation from proprietary telecom switches to a software implementation that runs on any commodity hardware. Prior to version 1.10.7, an attacker can perform a SIP digest leak attack against FreeSWITCH and receive the challenge response of a gateway configured on the FreeSWITCH server. This is done by challenging FreeSWITCH's SIP requests with the realm set to that of the gateway, thus forcing FreeSWITCH to respond with the challenge response which is based on the password of that targeted gateway. Abuse of this vulnerability allows attackers to potentially recover gateway passwords by performing a fast offline password cracking attack on the challenge response. The attacker does not require special network privileges, such as the ability to sniff the FreeSWITCH's network traffic, to exploit this issue. Instead, what is required for this attack to work is the ability to cause the victim server to send SIP request messages to the malicious party. Additionally, to exploit this issue, the attacker needs to specify the correct realm which might in some cases be considered secret. However, because many gateways are actually public, this information can easily be retrieved. The vulnerability appears to be due to the code which handles challenges in `sofia_reg.c`, `sofia_reg_handle_sip_r_challenge()` which does not check if the challenge is originating from the actual gateway. The lack of these checks allows arbitrary UACs (and gateways) to challenge any request sent by FreeSWITCH with the realm of the gateway being targeted. This issue is patched in version 10.10.7. Maintainers recommend that one should create an association between a SIP session for each gateway and its realm to make a check be put into place for this association when responding to challenges."], "published": "2021-10-26T14:15:08.007", "state": "PUBLIC", "vendorName": ["signalwire"], "productName": ["freeswitch"], "github": {"advisories": ["https://github.com/signalwire/freeswitch/security/advisories/GHSA-3v3f-99mv-qvj4"], "commits": [], "pocAdvisorie": {}, "repo": "https://github.com/signalwire/freeswitch/", "info": {"exist": true, "topics": ["freeswitch", "iot", "open-source", "signalwire", "sip", "source-code", "telephony", "voip", "webrtc"], "langs": {"C": 31599637, "C++": 10439031, "C#": 2842627, "JavaScript": 2322162, "Assembly": 974047, "Makefile": 515066, "Shell": 467224, "Perl": 409021, "ActionScript": 398179, "Python": 381128, "M4": 370683, "HTML": 176934, "Inno Setup": 105557, "Java": 92708, "Emacs Lisp": 52150, "CMake": 45612, "Limbo": 33051, "Lua": 27789, "Processing": 26297, "Batchfile": 26118, "CSS": 25926, "Dockerfile": 22509, "SWIG": 21501, "PHP": 18949, "BitBake": 16981, "Raku": 14158, "Meson": 13733, "Erlang": 12244, "Awk": 10011, "Smarty": 9425, "F#": 6108, "Pascal": 5512, "Roff": 5090, "Ruby": 3377, "GDB": 2805, "XSLT": 1957, "QMake": 1774, "Tcl": 1085, "QuickBASIC": 188}, "avatar": "https://avatars.githubusercontent.com/u/34925332?v=4", "stargazers": 3952, "language": "C"}}, "pocList": []}