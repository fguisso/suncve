{"cveId": "CVE-2021-21249", "cwe": ["CWE-74", "CWE-502", "CWE-74", "CWE-502"], "cvss": [{"baseScore": "9.6", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "Low", "Privileges Required": "Low", "User Interaction": "None", "Scope": "Complete", "Confidentiality Impact": "High", "Integrity Impact": "High", "Availability Impact": "None"}], "references": ["https://github.com/theonedev/onedev/security/advisories/GHSA-7xhq-m2q9-6hpm", "https://github.com/theonedev/onedev/commit/d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66"], "description": ["OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is an issue involving YAML parsing which can lead to post-auth remote code execution. In order to parse and process YAML files, OneDev uses SnakeYaml which by default (when not using `SafeConstructor`) allows the instantiation of arbitrary classes. We can leverage that to run arbitrary code by instantiating classes such as `javax.script.ScriptEngineManager` and using `URLClassLoader` to load the script engine provider, resulting in the instantiation of a user controlled class. For a full example refer to the referenced GHSA. This issue was addressed in 4.0.3 by only allowing certain known classes to be deserialized"], "published": "2021-01-15T21:15:13.740", "state": "PUBLIC", "vendorName": ["theonedev"], "productName": ["onedev"], "github": {"advisories": ["https://github.com/theonedev/onedev/security/advisories/GHSA-7xhq-m2q9-6hpm"], "commits": ["https://github.com/theonedev/onedev/commit/d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66"], "pocAdvisorie": {}, "repo": "https://github.com/theonedev/onedev/", "info": {"exist": true, "topics": ["ci-cd", "devops", "git", "kanban", "packages", "self-hosted"], "langs": {"Java": 11684939, "JavaScript": 733568, "HTML": 398349, "CSS": 180299, "Shell": 116784, "ANTLR": 47309, "Smarty": 17174, "Python": 5761, "Mustache": 3983, "Dockerfile": 125}, "avatar": "https://avatars.githubusercontent.com/u/44279871?v=4", "stargazers": 13837, "language": "Java"}}, "pocList": []}