{"cveId": "CVE-2023-46254", "cwe": ["CWE-200", "CWE-200", "CWE-200"], "cvss": [{"baseScore": "4.3", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "Low", "Privileges Required": "Low", "User Interaction": "None", "Scope": "Unchaged", "Confidentiality Impact": "Low", "Integrity Impact": "None", "Availability Impact": "None"}], "references": ["https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x", "https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5"], "description": ["capsule-proxy is a reverse proxy for Capsule kubernetes multi-tenancy framework. A bug in the RoleBinding reflector used by `capsule-proxy` gives ServiceAccount tenant owners the right to list Namespaces of other tenants backed by the same owner kind and name. For example consider two tenants `solar` and `wind`. Tenant `solar`, owned by a ServiceAccount named `tenant-owner` in the Namespace `solar`. Tenant `wind`, owned by a ServiceAccount named `tenant-owner` in the Namespace `wind`. The Tenant owner `solar` would be able to list the namespaces of the Tenant `wind` and vice-versa, although this is not correct. The bug introduces an exfiltration vulnerability since allows the listing of Namespace resources of other Tenants, although just in some specific conditions: 1. `capsule-proxy` runs with the `--disable-caching=false` (default value: `false`) and 2. Tenant owners are ServiceAccount, with the same resource name, but in different Namespaces. This vulnerability doesn't allow any privilege escalation on the outer tenant Namespace-scoped resources, since the Kubernetes RBAC is enforcing this. This issue has been addressed in version 0.4.5. Users are advised to upgrade. There are no known workarounds for this vulnerability."], "published": "2023-11-06T19:15:09.230", "state": "PUBLIC", "vendorName": ["projectcapsule"], "productName": ["capsule-proxy"], "github": {"advisories": ["https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x"], "commits": ["https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5"], "pocAdvisorie": {}, "repo": "https://github.com/projectcapsule/capsule-proxy/", "info": {"exist": true, "topics": ["capsule", "kubernetes", "kubernetes-controller", "multitenancy", "multitenant"], "langs": {"Go": 185968, "Shell": 120731, "Makefile": 14550, "Smarty": 13875, "Dockerfile": 793, "JavaScript": 608}, "avatar": "https://avatars.githubusercontent.com/u/147177907?v=4", "stargazers": 48, "language": "Go"}}, "pocList": []}