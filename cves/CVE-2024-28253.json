{"cveId": "CVE-2024-28253", "cwe": ["CWE-94", "CWE-94", "CWE-94"], "cvss": [{"baseScore": "9.4", "version": "3.1", "Attack Vector": "None", "Attack Complexity": "Low", "Privileges Required": "None", "User Interaction": "None", "Scope": "Unchaged", "Confidentiality Impact": "High", "Integrity Impact": "High", "Availability Impact": "Low"}], "references": ["https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-7vf4-x5m2-r6gr", "https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection", "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/EntityRepository.java#L693", "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/EntityResource.java#L219", "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/policies/PolicyResource.java#L365", "https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/PolicyRepository.java#L113"], "description": ["OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. `CompiledRule::validateExpression` is also called from `PolicyRepository.prepare`. `prepare()` is called from `EntityRepository.prepareInternal()` which, in turn, gets called from `EntityResource.createOrUpdate()`. Note that even though there is an authorization check (`authorizer.authorize()`), it gets called after `prepareInternal()` gets called and therefore after the SpEL expression has been evaluated. In order to reach this method, an attacker can send a PUT request to `/api/v1/policies` which gets handled by `PolicyResource.createOrUpdate()`. This vulnerability was discovered with the help of CodeQL's Expression language injection (Spring) query and is also tracked as `GHSL-2023-252`. This issue may lead to Remote Code Execution and has been addressed in version 1.3.1. Users are advised to upgrade. There are no known workarounds for this vulnerability."], "published": "2024-03-15T20:15:09.807", "state": "PUBLIC", "vendorName": ["open-metadata"], "productName": ["OpenMetadata"], "github": {"advisories": ["https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-7vf4-x5m2-r6gr"], "commits": [], "pocAdvisorie": {"url": "https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-7vf4-x5m2-r6gr", "kw": ["proof of concept"]}, "repo": "https://github.com/open-metadata/OpenMetadata/", "info": {"exist": true, "topics": ["data-catalog", "data-collaboration", "data-contracts", "data-discovery", "data-governance", "data-lineage", "data-observability", "data-profiling", "data-quality", "data-quality-checks", "data-science", "data-validation", "datadiscovery", "dataengineering", "dataquality", "dbt", "hacktoberfest", "metadata", "metadata-management", "snowflake"], "langs": {"TypeScript": 16191389, "Java": 8695717, "Python": 7373038, "Less": 532307, "CSS": 99314, "JavaScript": 56179, "Shell": 37643, "PLpgSQL": 26903, "HTML": 25311, "Makefile": 16698, "Dockerfile": 13025, "ANTLR": 3908, "LookML": 1580, "Jinja": 285}, "avatar": "https://avatars.githubusercontent.com/u/86132257?v=4", "stargazers": 6400, "language": "TypeScript"}}, "pocList": []}